{% extends "base.html" %} {% block title %}Create Post{% endblock %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Upcyle - Create Post</title>
    <link rel="stylesheet" href="/css/Create-Post.css"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap">
    <link rel="shortcut icon" href="/src/img/Logo/NGOlogo.png" type="image/x-icon">    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body  style="background-color: #F4F4F4;">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>

{% block content %}
<div class="div my-5"></div>
<form method="POST" enctype="multipart/form-data">
    <div class="container">
    <!-- POST INFO-->
    <div class="container post-info col-xl-8 col-xs-12 pb-4" style="background-color: white;">
        <div class="row">
            <!-- CATEGORY -->
            <div class="my-3">
                <label for="post-form-category" class="form-label"><strong>Category*</strong></label>
                <select class="form-select" id="chosenCat" name="chosenCat" aria-label="Default select example">
                    <option selected>Choose a category</option>
                    <option value="1">Plastic</option>
                    <option value="2">Paper</option>
                    <option value="3">Textile</option>
                    <option value="4">Glass</option>
                </select>
            </div>
            <!-- TITLE -->
            <div class="my-3">
                <label for="post-form-title" class="form-label"><strong>Title*</strong></label>
                <textarea class="form-control" name="postTitle" id="postTitle" placeholder="Add title here" rows="1"></textarea>
            </div>
            <div class="row g-3">
                <!-- DESCRIPTION -->
                <div class="col post-description px-5">
                    <div class="mb-3">
                        <label for="exampleFormControlTextarea1" class="form-label"><strong>Description:*</strong></label>
                        <textarea class="form-control" id="postDescription" name="postDescription" placeholder="Add post description..." rows="5"></textarea>
                    </div>
                </div>
                <!-- MATERIALS NEEDED -->
                    <div class="col post-description">
                        <div class="mb-3">
                            <label for="exampleFormControlTextarea1" class="form-label"><strong>Materials Needed:*</strong></label>
                            <textarea class="form-control" id="postMaterial" name="postMaterial" placeholder="Add needed materials..." rows="5"></textarea>
                        </div>
                    </div>
            </div>
        </div>
    </div>

    <script>scr="new-instruction.js"</script>
    <!-- POST CONTENT -->
    <div class="container post-content col-xl-8 col-xs-12 mt-3" id="parentInstruction">
        <div class="row" id="instruction1" name="instruction1">
            <div class="container px-3 py-2 post-instruction-title rounded-top text-white" style="background-color: #F06205; height: 70px;">
                <div class="row align-items-center">
                    <!-- INSTRUCTION -->
                    <div class="col post-instruction">
                        <div class="form-floating">
                            <textarea class="form-control" placeholder="Add instruction here" name="instructionTitle" id="instructionTitle" style="background-color: #F06205; border: 0px"></textarea>
                            <label for="instructionTitle">Instruction</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container py-4" style="background-color: white;">

                <!-- IMG -->
                <div class="row">
                    <div class="container d-flex align-items-center justify-content-center" style="background-color: rgb(223, 223, 223); height: 450px;">
                        <div class="text-center">
                            <form id="imageForm">
                                <label for="instructionImage" id="uploadLabel" style="display: block; font-family: 'Lato', sans-serif; font-weight: bold; font-size: 45px; color: #7E7E7E; margin-bottom: 20px;">[Insert Image Here]</label>
                                <input type="file" id="instructionImage" name="instructionImage" accept="image/*" style="display: none;" />
                                <img id="uploadedImage" src="" alt="Uploaded Image" style="width: 100%; height: 100%; max-height: 450px; cursor: pointer; display: none;">
                                <img src="/backend/website/images/image icon.jpg" alt="Image Icon" id="imageIcon" style="width: 70px; height: 70px; margin-top: 20px; cursor: pointer;">
                            </form>
                        </div>
                    </div>

                    <script>
                        document.getElementById('imageForm').addEventListener('click', function() {
                            document.getElementById('instructionImage').click();
                        });
                
                        document.getElementById('instructionImage').addEventListener('change', function() {
                            var uploadedImage = document.getElementById('uploadedImage');
                            var uploadLabel = document.getElementById('uploadLabel');
                            var imageIcon = document.getElementById('imageIcon');
                            var fileInput = document.getElementById('instructionImage');
                            var file = fileInput.files[0];
                            var reader = new FileReader();
                
                            reader.onload = function(e) {
                                uploadedImage.src = e.target.result;
                                uploadedImage.style.display = 'block';
                                uploadLabel.style.display = 'none';
                                imageIcon.style.display = 'none';
                            };
                
                            reader.readAsDataURL(file);
                        });
                
                        document.getElementById('uploadedImage').addEventListener('click', function() {
                            document.getElementById('imageUpload').click();
                        });
                    </script>

                </div>

                <!-- IMG DESCRIPTION -->
                <div class="row pt-2 px-4">
                    <div class="form-floating">
                        <textarea class="form-control px-4" placeholder="Leave a comment here" id="stepDescription" name="stepDescription" style="height: 100px"></textarea>
                        <label class="ms-4" for="stepDescription">Add description here...</label>
                    </div>
                </div>

            </div>
            <hr>
        </div>
    </div>

    <div class="container post-content col-xl-8 col-xs-12 mt-3">
        <div class="row">
            <button type="button" id="addInstructionButton" class="btn text-white" style="background-color: #F06205;">Add Instruction</button>
        </div>
        <script src="{{ url_for('static', filename='js/new-instruction.js')}}"></script>
    </div>
    
    <!-- REFERENCES -->
    <div class="container post-content col-xl-8 col-xs-12 mt-3" style="background-color: white;">
        <div class="row p-3">
            <p class="label h1">References:</p>
            <hr>
            <div id="postReferences" name="postReferences">
                <!-- References will be dynamically added here -->
            </div>
            <div class="row">
                <div class="mb-3">
                    <textarea id="addReferences" name="addReferences" class="form-control" rows="5" placeholder="Add references..." style="resize: none;"></textarea>
                </div>
            </div>
        </div>
    </div>

    <div class="container post-content col-xl-8 col-xs-12 mt-3">
        <div class="row">
            <button type="button" id="addReferenceButton" class="btn text-white" style="background-color: #F06205;">Add Reference</button>
        </div>
        <script>
            document.getElementById('addReferenceButton').addEventListener('click', function () {
                var referenceText = document.getElementById('addReferences').value;
                
                if (referenceText.trim() !== "") {
                    var referenceList = document.getElementById('postReferences');
                    var newReference = document.createElement('div');
                    newReference.className = 'mb-2 d-flex justify-content-between align-items-center';
                    newReference.innerHTML = '<a href="' + referenceText + '" target="_blank" class="mb-0 me-2">' + referenceText + '</a>' +
                    '<button type="button" class="btn btn-danger btn-sm delete-btn" style="background: none; border: none; color: #808080;">X</button>';
                    referenceList.appendChild(newReference);
    
                    // Clear the input after adding a reference
                    document.getElementById('addReferences').value = "";

                    var deleteButtons = document.getElementsByClassName('delete-btn');
                    for (var i = 0; i < deleteButtons.length; i++) {
                        deleteButtons[i].addEventListener('click', function () {
                        this.parentNode.remove();
                        });
                    }
                }
            });
        </script>
    </div>

    <br>
    <div class="row justify-content-center mx-5">
        <button type="submit" class="btn text-white justify-content-center" style="background-color:#08989F;">Submit</button></div>
        <div class="div my-5"></div>
    </div>
</form>
{% endblock content %}
</body>    
</html>